schema: '2.0'
stages:
  data_cleaning:
    cmd: python -m bike_sharing.dataset
    deps:
    - path: bike_sharing/dataset.py
      hash: md5
      md5: 0856a100747fb4d41a9714aab4480f83
      size: 27737
    - path: data/raw/bike_sharing_modified.csv
      hash: md5
      md5: 1484028223d304a18ddd9ce33a1af441
      size: 1686247
    - path: data/raw/bike_sharing_original.csv
      hash: md5
      md5: 7747b2efcdd3801b83c1cfce2d600c15
      size: 1144308
    params:
      params.yaml:
        data_cleaning:
          input_path: data/raw/bike_sharing_modified.csv
          original_path: data/raw/bike_sharing_original.csv
          output_path: data/processed/bike_sharing_cleaned.csv
    outs:
    - path: data/processed/bike_sharing_cleaned.csv
      hash: md5
      md5: b630a13d1a4ba8d60b07de4b6b42113b
      size: 1168790
  feature_engineering:
    cmd: python -m bike_sharing.features
    deps:
    - path: bike_sharing/features.py
      hash: md5
      md5: 137f8ecc9f4002ea2a7ed0bc88b402bc
      size: 7644
    - path: data/processed/bike_sharing_cleaned.csv
      hash: md5
      md5: b630a13d1a4ba8d60b07de4b6b42113b
      size: 1168790
    params:
      params.yaml:
        feature_engineering:
          input_path: data/processed/bike_sharing_cleaned.csv
          output_path: data/processed/bike_sharing_transformed.csv
    outs:
    - path: data/processed/bike_sharing_transformed.csv
      hash: md5
      md5: 9054add26646194ac5f6e48c10d24eb9
      size: 10379861
  train_random_forest:
    cmd: python -m bike_sharing.modeling.train random_forest --batch
    deps:
    - path: bike_sharing/modeling/train.py
      hash: md5
      md5: cd7a81f1c7a084815e0680377f626f37
      size: 14565
    - path: data/processed/bike_sharing_transformed.csv
      hash: md5
      md5: 9054add26646194ac5f6e48c10d24eb9
      size: 10379861
    params:
      params.yaml:
        mlflow:
          experiment_name: Bike_Sharing_DVC_Pipeline
          tracking_uri: ./mlruns
        models.random_forest:
          model_class: RandomForestRegressor
          configs:
          - n_estimators: 100
            max_depth: 10
            random_state: 42
            n_jobs: -1
          - n_estimators: 200
            max_depth: 20
            random_state: 42
            n_jobs: -1
          - n_estimators: 300
            max_depth: 15
            min_samples_leaf: 2
            random_state: 42
            n_jobs: -1
          - n_estimators: 500
            max_depth: 15
            random_state: 42
            n_jobs: -1
          - n_estimators: 500
            max_depth: 25
            min_samples_leaf: 1
            random_state: 42
            n_jobs: -1
          - n_estimators: 300
            max_depth: 18
            min_samples_leaf: 2
            min_samples_split: 5
            random_state: 42
            n_jobs: -1
        models_output:
          dir: models
          save_all_configs: false
        train:
          input_path: data/processed/bike_sharing_transformed.csv
          test_size: 0.2
          random_state: 42
    outs:
    - path: models/RandomForestRegressor_casual.pkl
      hash: md5
      md5: f5217fdec7c360b640ad1d1842b39f16
      size: 19640490
    - path: models/RandomForestRegressor_metadata.json
      hash: md5
      md5: a8bb7dafa924adf441870e7480908342
      size: 444
    - path: models/RandomForestRegressor_registered.pkl
      hash: md5
      md5: 6773084b1def89783a1b0a593085579d
      size: 39253002
  train_elastic_net:
    cmd: python -m bike_sharing.modeling.train elastic_net --batch
    deps:
    - path: bike_sharing/modeling/train.py
      hash: md5
      md5: cd7a81f1c7a084815e0680377f626f37
      size: 14565
    - path: data/processed/bike_sharing_transformed.csv
      hash: md5
      md5: 9054add26646194ac5f6e48c10d24eb9
      size: 10379861
    params:
      params.yaml:
        mlflow:
          experiment_name: Bike_Sharing_DVC_Pipeline
          tracking_uri: ./mlruns
        models.elastic_net:
          model_class: ElasticNet
          configs:
          - alpha: 0.1
            l1_ratio: 0.5
            random_state: 42
            max_iter: 10000
          - alpha: 0.001
            l1_ratio: 0.8
            random_state: 42
            max_iter: 10000
          - alpha: 0.1
            l1_ratio: 0.6
            random_state: 42
            max_iter: 10000
          - alpha: 0.005
            l1_ratio: 0.9
            random_state: 42
            max_iter: 10000
        models_output:
          dir: models
          save_all_configs: false
        train:
          input_path: data/processed/bike_sharing_transformed.csv
          test_size: 0.2
          random_state: 42
    outs:
    - path: models/ElasticNet_casual.pkl
      hash: md5
      md5: e4313317323e922543d9dbb17057dcd7
      size: 4854
    - path: models/ElasticNet_metadata.json
      hash: md5
      md5: 7f85f501b6de05c959bb015f55e29aa2
      size: 414
    - path: models/ElasticNet_registered.pkl
      hash: md5
      md5: eee9f46ddaa6f35aef3b482a3f1955aa
      size: 4854
  train_svr:
    cmd: python -m bike_sharing.modeling.train svr --batch
    deps:
    - path: bike_sharing/modeling/train.py
      hash: md5
      md5: cd7a81f1c7a084815e0680377f626f37
      size: 14565
    - path: data/processed/bike_sharing_transformed.csv
      hash: md5
      md5: 9054add26646194ac5f6e48c10d24eb9
      size: 10379861
    params:
      params.yaml:
        mlflow:
          experiment_name: Bike_Sharing_DVC_Pipeline
          tracking_uri: ./mlruns
        models.svr:
          model_class: SVR
          configs:
          - kernel: rbf
            C: 10
            epsilon: 0.1
          - kernel: rbf
            C: 1
            epsilon: 0.05
        models_output:
          dir: models
          save_all_configs: false
        train:
          input_path: data/processed/bike_sharing_transformed.csv
          test_size: 0.2
          random_state: 42
    outs:
    - path: models/SVR_casual.pkl
      hash: md5
      md5: 5e4190497542f406910bff41f3f48236
      size: 18576495
    - path: models/SVR_metadata.json
      hash: md5
      md5: 158bd70298ff5a9f235b7f1983e7fc6a
      size: 361
    - path: models/SVR_registered.pkl
      hash: md5
      md5: e0cb71721bacaab593329f3a5b44f518
      size: 18133815
  train_xgboost:
    cmd: python -m bike_sharing.modeling.train xgboost --batch
    deps:
    - path: bike_sharing/modeling/train.py
      hash: md5
      md5: cd7a81f1c7a084815e0680377f626f37
      size: 14565
    - path: data/processed/bike_sharing_transformed.csv
      hash: md5
      md5: 9054add26646194ac5f6e48c10d24eb9
      size: 10379861
    params:
      params.yaml:
        mlflow:
          experiment_name: Bike_Sharing_DVC_Pipeline
          tracking_uri: ./mlruns
        models.xgboost:
          model_class: XGBRegressor
          configs:
          - n_estimators: 150
            max_depth: 5
            random_state: 42
            learning_rate: 0.1
          - n_estimators: 300
            max_depth: 7
            random_state: 42
            learning_rate: 0.05
          - n_estimators: 400
            max_depth: 6
            random_state: 42
            learning_rate: 0.03
          - n_estimators: 500
            max_depth: 5
            random_state: 42
            learning_rate: 0.05
        models_output:
          dir: models
          save_all_configs: false
        train:
          input_path: data/processed/bike_sharing_transformed.csv
          test_size: 0.2
          random_state: 42
    outs:
    - path: models/XGBRegressor_casual.pkl
      hash: md5
      md5: 7f539f943bbdcb2371060ecd5ec783be
      size: 305207
    - path: models/XGBRegressor_metadata.json
      hash: md5
      md5: 8627e5a2fada08815fba26b15e0f1931
      size: 425
    - path: models/XGBRegressor_registered.pkl
      hash: md5
      md5: c997ea5ef27fd2a7e65bd68c42b61ab9
      size: 324997
  train_lightgbm:
    cmd: python -m bike_sharing.modeling.train lightgbm --batch
    deps:
    - path: bike_sharing/modeling/train.py
      hash: md5
      md5: cd7a81f1c7a084815e0680377f626f37
      size: 14565
    - path: data/processed/bike_sharing_transformed.csv
      hash: md5
      md5: 9054add26646194ac5f6e48c10d24eb9
      size: 10379861
    params:
      params.yaml:
        mlflow:
          experiment_name: Bike_Sharing_DVC_Pipeline
          tracking_uri: ./mlruns
        models.lightgbm:
          model_class: LGBMRegressor
          configs:
          - n_estimators: 150
            max_depth: 10
            random_state: 42
            learning_rate: 0.1
            n_jobs: -1
          - n_estimators: 300
            max_depth: 15
            random_state: 42
            learning_rate: 0.05
            n_jobs: -1
          - n_estimators: 400
            max_depth: 12
            random_state: 42
            learning_rate: 0.03
            n_jobs: -1
          - n_estimators: 600
            max_depth: 15
            random_state: 42
            learning_rate: 0.05
            n_jobs: -1
        models_output:
          dir: models
          save_all_configs: false
        train:
          input_path: data/processed/bike_sharing_transformed.csv
          test_size: 0.2
          random_state: 42
    outs:
    - path: models/LGBMRegressor_casual.pkl
      hash: md5
      md5: b344fee6e1d8ab3667d6502950cf4da8
      size: 1206233
    - path: models/LGBMRegressor_metadata.json
      hash: md5
      md5: 2856e1dc218ccc98a87b704434881d12
      size: 449
    - path: models/LGBMRegressor_registered.pkl
      hash: md5
      md5: 79d5bea8454110d59f6ab4ed3db67b8b
      size: 1203323
